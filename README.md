# PICO

PICO是一个简单的物联网通讯协议，适用于网关与服务器之间，服务器与服务器之间通讯。
协议参考了MQTT及其他总线协议设计，支持请求/响应模式、订阅发布，和数据流。

## 一、包头

| 标识   | 长度（位） | 说明                 |
|------|-------|--------------------|
| 魔术头  | 32    | "PICO"             |
| 包序号  | 16    | 0-65535，客户端服务端各自维持 |
| 包类型  | 4     | 0-15               |
| 数据格式 | 4     | 0-15               |
| 数据长度 | 24    | 0-16777216，0-16MB  |

## 二、包类型

| id | 类型              | 方向 | 说明     |
|----|-----------------|----|--------|
| 0  | -               | -  | 预留     |
| 1  | CONNECT         | 上行 | 连接     |
| 2  | CONNECT_ACK     | 下行 | 连接响应   |
| 3  | PING            | 双向 | ping   |
| 4  | PONG            | 双向 | pong   |
| 5  | REQUEST         | 双向 | 请求     |
| 6  | RESPONSE        | 双向 | 响应     |
| 7  | STREAM          | 双向 | 数据流    |
| 8  | STREAM_END      | 双向 | 数据流结束  |
| 9  | PUBLISH         | 双向 | 发布     |
| 10 | PUBLISH_ACK     | 双向 | 发布响应   |
| 11 | SUBSCRIBE       | 上行 | 订阅     |
| 12 | SUBSCRIBE_ACK   | 下行 | 订阅响应   |
| 13 | UNSUBSCRIBE     | 上行 | 取消订阅   |
| 14 | UNSUBSCRIBE_ACK | 下行 | 取消订阅响应 |
| 15 | DISCONNECT      | 双向 | 关闭连接   |

## 三、数据格式

| id   | 类型      | 说明         |
|------|---------|------------|
| 0    | binary  | 默认二进制      |
| 1    | json    | 通用性强       |
| 2    | xml     | 比较老旧，不建议使用 |
| 3    | yaml    | 较JSON省流，清晰 |
| 4    | msgpack | 省流，高性能     |
| 5-15 | custom  | 自定义        |

## 四、通讯规约







